<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<VBox xmlns="http://javafx.com/javafx/11.0.1"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.yuzj.autolink.plc.control.AlarmControl"
      spacing="15" VBox.vgrow="ALWAYS" style="-fx-padding: 20; -fx-background-color: #f8f9fa;">

    <!-- 页面标题 -->
    <HBox alignment="CENTER_LEFT">
        <Label text="报警管理系统" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Label text="实时监控工业设备状态" style="-fx-font-size: 14px; -fx-text-fill: #7f8c8d;"/>
    </HBox>

    <!-- 控制面板 -->
    <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);">
        <padding>
            <Insets top="15" right="20" bottom="15" left="20"/>
        </padding>
        <HBox spacing="15" alignment="CENTER_LEFT">
            <Label text="操作面板" style="-fx-font-weight: bold; -fx-text-fill: #34495e; -fx-font-size: 16px;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="refreshButton" text="🔄 刷新" onAction="#handleRefresh"
                    style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;"/>
            <Button fx:id="acknowledgeSelectedButton" text="✅ 确认选中" onAction="#handleAcknowledgeAlarms"
                    style="-fx-background-color: #2ecc71; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;"/>
            <Button fx:id="acknowledgeAllButton" text="✅ 确认所有" onAction="#handleAcknowledgeAll"
                    style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;"/>
            <Button fx:id="clearButton" text="🗑 清除选中" onAction="#handleClearAlarms"
                    style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5;"/>
        </HBox>
    </VBox>

    <!-- 报警统计卡片 -->
    <HBox spacing="15">
        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
              HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            <Label text="总报警数" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
            <Label text="0" fx:id="totalAlarmCount"
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #3498db;"/>
        </VBox>

        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
              HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            <Label text="未确认报警" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
            <Label text="0" fx:id="unacknowledgedCount"
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #e74c3c;"/>
        </VBox>

        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
              HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            <Label text="紧急报警" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
            <Label text="0" fx:id="criticalAlarmCount"
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #c0392b;"/>
        </VBox>
    </HBox>

    <!-- 报警表格区域 -->
    <VBox spacing="5"
          style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
          VBox.vgrow="ALWAYS">
        <padding>
            <Insets top="15" right="15" bottom="15" left="15"/>
        </padding>
        <HBox spacing="10" alignment="CENTER_LEFT">
            <Label text="报警记录列表" style="-fx-font-weight: bold; -fx-text-fill: #34495e; -fx-font-size: 16px;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <TextField fx:id="searchField" promptText="搜索报警..." style="-fx-background-radius: 5;"/>
            <ComboBox fx:id="filterComboBox" promptText="筛选条件" style="-fx-background-radius: 5;"/>
        </HBox>

        <TableView fx:id="alarmTable" VBox.vgrow="ALWAYS" style="-fx-border-color: #ecf0f1;">
            <columns>
                <TableColumn fx:id="tagNameColumn" text="标签名称" prefWidth="120" style="-fx-alignment: CENTER-LEFT;"/>
                <TableColumn fx:id="alarmTypeColumn" text="报警类型" prefWidth="100"
                             style="-fx-alignment: CENTER-LEFT;"/>
                <TableColumn fx:id="alarmMessageColumn" text="报警信息" prefWidth="180"
                             style="-fx-alignment: CENTER-LEFT;"/>
                <TableColumn fx:id="alarmLevelColumn" text="报警级别" prefWidth="90" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="alarmValueColumn" text="数据值" prefWidth="80"
                             style="-fx-alignment: CENTER-RIGHT;"/>
                <TableColumn fx:id="timestampColumn" text="报警时间" prefWidth="160" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="acknowledgedColumn" text="确认状态" prefWidth="90" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="acknowledgedTimeColumn" text="确认时间" prefWidth="160"
                             style="-fx-alignment: CENTER;"/>
            </columns>
            <placeholder>
                <Label text="暂无报警记录" style="-fx-text-fill: #95a5a6;"/>
            </placeholder>
        </TableView>
    </VBox>

    <!-- 日志和状态区域 -->
    <HBox spacing="15" VBox.vgrow="NEVER">
        <!-- 操作日志区域 -->
        <VBox spacing="5"
              style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
              HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="15" right="15" bottom="15" left="15"/>
            </padding>
            <HBox spacing="10" alignment="CENTER_LEFT">
                <Label text="操作日志" style="-fx-font-weight: bold; -fx-text-fill: #34495e; -fx-font-size: 14px;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="清空日志"
                        style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-size: 12px; -fx-background-radius: 3;"/>
            </HBox>
            <TextArea fx:id="logArea" prefHeight="120" editable="false"
                      style="-fx-border-color: #ecf0f1; -fx-background-color: #fdfdfd; -fx-font-family: 'Consolas', 'Monaco', monospace;"/>
        </VBox>
    </HBox>

    <!-- 状态栏 -->
    <HBox spacing="10" style="-fx-padding: 10; -fx-background-color: #34495e; -fx-background-radius: 6;">
        <Label fx:id="statusLabel" text="系统就绪" style="-fx-text-fill: #ecf0f1; -fx-font-size: 12px;"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Label text="最后更新:" style="-fx-text-fill: #bdc3c7; -fx-font-size: 12px;"/>
        <Label fx:id="lastUpdateTime" text="--:--:--"
               style="-fx-text-fill: #ecf0f1; -fx-font-size: 12px; -fx-font-weight: bold;"/>
    </HBox>
</VBox>
