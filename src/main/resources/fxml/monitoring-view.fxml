<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<VBox xmlns="http://javafx.com/javafx/11.0.1"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.yuzj.autolink.plc.control.MonitoringControl"
      spacing="15" VBox.vgrow="ALWAYS" style="-fx-padding: 20; -fx-background-color: #f8f9fa;">

    <!-- 页面标题 -->
    <HBox alignment="CENTER_LEFT">
        <Label text="实时数据监控" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Label text="工业数据实时监测与分析" style="-fx-font-size: 14px; -fx-text-fill: #7f8c8d;"/>
    </HBox>

    <!-- 监控控制面板 -->
    <VBox spacing="15"
          style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);">
        <padding>
            <Insets top="20" right="25" bottom="20" left="25"/>
        </padding>

        <!-- 控制面板标题和按钮 -->
        <HBox spacing="15" alignment="CENTER_LEFT">
            <Label text="监控控制面板" style="-fx-font-weight: bold; -fx-text-fill: #34495e; -fx-font-size: 18px;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="addTagButton" text="➕ 添加监控点" onAction="#handleAddTag"
                    style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 8 15;"/>
            <Button fx:id="importTagsButton" text="📥 导入配置" onAction="#handleImportTags"
                    style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 8 15;"/>
            <Button fx:id="exportTagsButton" text="📤 导出配置" onAction="#handleExportTags"
                    style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 8 15;"/>
            <Button fx:id="clearDataButton" text="🗑 清除数据" onAction="#handleClearData"
                    style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 8 15;"/>
        </HBox>

        <!-- 搜索和筛选区域 -->
        <HBox spacing="15" alignment="CENTER_LEFT">
            <Label text="搜索:" style="-fx-font-weight: bold; -fx-text-fill: #34495e;"/>
            <TextField fx:id="searchField" promptText="搜索产品名或地址..." prefWidth="200"
                       style="-fx-background-radius: 5; -fx-border-color: #bdc3c7; -fx-border-radius: 5;"/>

            <Label text="数据类型:" style="-fx-font-weight: bold; -fx-text-fill: #34495e;"/>
            <ComboBox fx:id="dataTypeFilter" prefWidth="120" promptText="全部类型"
                      style="-fx-background-radius: 5; -fx-border-color: #bdc3c7; -fx-border-radius: 5;"/>

            <Region HBox.hgrow="ALWAYS"/>

            <Label fx:id="dataPointCountLabel" text="数据点: 0" style="-fx-font-weight: bold; -fx-text-fill: #27ae60;"/>
        </HBox>
    </VBox>

    <!-- 数据统计卡片 -->
    <HBox spacing="15">
        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
              HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            <Label text="总监控点数" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
            <Label fx:id="totalTagsCount" text="0"
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #3498db;"/>
        </VBox>

        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
              HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            <Label text="在线监控点" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
            <Label fx:id="onlineTagsCount" text="0"
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #27ae60;"/>
        </VBox>

        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
              HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="15" right="20" bottom="15" left="20"/>
            </padding>
            <Label text="异常数据" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14px;"/>
            <Label fx:id="errorDataCount" text="0"
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #e74c3c;"/>
        </VBox>
    </HBox>

    <!-- 数据表格区域 -->
    <VBox spacing="5"
          style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);"
          VBox.vgrow="ALWAYS">
        <padding>
            <Insets top="15" right="15" bottom="15" left="15"/>
        </padding>

        <HBox spacing="10" alignment="CENTER_LEFT">
            <Label text="实时监控数据表" style="-fx-font-weight: bold; -fx-text-fill: #34495e; -fx-font-size: 16px;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="refreshTableButton" text="🔄 刷新" onAction="#handleRefreshTable"
                    style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 6 12;"/>
        </HBox>

        <TableView fx:id="dataTable" VBox.vgrow="ALWAYS" style="-fx-border-color: #ecf0f1;">
            <columns>
                <TableColumn fx:id="productNameColumn" text="产品名" prefWidth="150"
                             style="-fx-alignment: CENTER-LEFT;"/>
                <TableColumn fx:id="addressColumn" text="PLC地址" prefWidth="130" style="-fx-alignment: CENTER-LEFT;"/>
                <TableColumn fx:id="valueColumn" text="当前值" prefWidth="110" style="-fx-alignment: CENTER-RIGHT;"/>
                <TableColumn fx:id="dataTypeColumn" text="数据类型" prefWidth="100" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="qualityColumn" text="数据质量" prefWidth="90" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="timestampColumn" text="更新时间" prefWidth="160" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="actionColumn" text="操作" prefWidth="100" style="-fx-alignment: CENTER;"/>
            </columns>
            <placeholder>
                <Label text="暂无监控数据" style="-fx-text-fill: #95a5a6;"/>
            </placeholder>
        </TableView>
    </VBox>

    <!-- 刷新控制区域 -->
    <VBox spacing="5"
          style="-fx-background-color: white; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 6, 0, 0, 2);">
        <padding>
            <Insets top="15" right="25" bottom="15" left="25"/>
        </padding>

        <HBox spacing="20" alignment="CENTER_LEFT">
            <Label text="数据刷新控制" style="-fx-font-weight: bold; -fx-text-fill: #34495e; -fx-font-size: 16px;"/>

            <Label text="刷新间隔:" style="-fx-font-weight: bold; -fx-text-fill: #34495e;"/>
            <TextField fx:id="refreshIntervalField" text="100" prefWidth="80"
                       style="-fx-background-radius: 5; -fx-border-color: #bdc3c7; -fx-border-radius: 5; -fx-alignment: CENTER-RIGHT;"/>
            <Label text="ms" style="-fx-text-fill: #34495e;"/>

            <Button fx:id="applyRefreshButton" text="应用设置" onAction="#handleApplyRefreshInterval"
                    style="-fx-background-color: #2ecc71; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 8 15;"/>

            <Region HBox.hgrow="ALWAYS"/>

            <ToggleButton fx:id="autoRefreshToggle" text="自动刷新" selected="true"
                          style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 5; -fx-padding: 8 15;"/>

            <Label fx:id="lastRefreshTimeLabel" text="最后刷新: --:--:--"
                   style="-fx-text-fill: #7f8c8d; -fx-font-size: 12px;"/>
        </HBox>
    </VBox>

    <!-- 状态栏 -->
    <HBox spacing="10" style="-fx-padding: 10; -fx-background-color: #34495e; -fx-background-radius: 6;">
        <Label fx:id="statusLabel" text="监控系统就绪" style="-fx-text-fill: #ecf0f1; -fx-font-size: 12px;"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Label text="系统状态:" style="-fx-text-fill: #bdc3c7; -fx-font-size: 12px;"/>
        <Label fx:id="systemStatus" text="正常运行"
               style="-fx-text-fill: #27ae60; -fx-font-size: 12px; -fx-font-weight: bold;"/>
    </HBox>
</VBox>
